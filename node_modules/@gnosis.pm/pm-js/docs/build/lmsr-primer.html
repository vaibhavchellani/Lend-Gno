

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>LMSR Primer &mdash; pm-js  documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="pm-js  documentation" href="index.html"/>
        <link rel="next" title="Contributing Guide" href="contributing-guide.html"/>
        <link rel="prev" title="Events, Oracles and Markets" href="events-oracles-and-markets.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> pm-js
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-overview.html">API Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="events-oracles-and-markets.html">Events, Oracles and Markets</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">LMSR Primer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#bounded-loss-from-the-b-parameter">Bounded Loss from the \(b\) Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="#marginal-price-of-outcome-tokens">Marginal Price of Outcome Tokens</a></li>
<li class="toctree-l2"><a class="reference internal" href="#lmsr-calculation-functions">LMSR Calculation Functions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contributing-guide.html">Contributing Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="api-reference.html">API Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pm-js</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>LMSR Primer</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/lmsr-primer.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="lmsr-primer">
<span id="lmsr-primer"></span><h1>LMSR Primer<a class="headerlink" href="#lmsr-primer" title="Permalink to this headline">¶</a></h1>
<p>The pm-js implementation of the logarithmic market scoring rule mostly follows the <a class="reference external" href="http://mason.gmu.edu/~rhanson/mktscore.pdf">original specification</a>. It is based on the following cost function:</p>
<p>$$ C(\vec{q}) = b \log \left( \sum_i \exp \left( { q_i \over b } \right) \right) $$</p>
<p>where</p>
<ul class="simple">
<li>\(\vec{q}\) is a vector of <em>net</em> quantities of outcome tokens <em>sold</em>. What this means is that although the market selling outcome tokens increases the net quantity sold, the market <em>buying</em> outcome tokens <em>decreases</em> the net quantity sold.</li>
<li>\(b\) is a liquidity parameter which controls the bounded loss of the LMSR. That bounded loss for the market maker means that the liquidity parameter can be expressed in terms of the number of outcomes and the funding required to guarantee all outcomes sold by the market maker can be backed by collateral (this will be derived later).</li>
<li>\(\log\) and \(\exp\) are the natural logarithm and exponential functions respectively</li>
</ul>
<p>The cost function is used to determine the cost of a transaction in the following way: suppose \(\vec{q_1}\) is the state of net quantities sold before the transaction and \(\vec{q_2}\) is this state afterwards. Then the cost of the transaction \(\nu\) is</p>
<p>$$ \nu = C(\vec{q_2}) - C(\vec{q_1}) $$</p>
<p>For example, suppose there is a LMSR-operated market with a \(b\) of 5 and two outcomes. If this market has bought 10 tokens for outcome A and sold 4 tokens for outcome B, it would have a cost level of:</p>
<p>$$ C \begin{pmatrix} -10 \\ 4 \end{pmatrix} = 5 \log \left( \exp(-10/5) + \exp(4/5) \right) \approx 4.295 $$</p>
<p>Buying 5 tokens for outcome A (or having the market sell you those tokens) would change the cost level to:</p>
<p>$$ C \begin{pmatrix} -10 + 5 \\ 4 \end{pmatrix} = 5 \log \left( \exp(-5/5) + \exp(4/5) \right) \approx 4.765 $$</p>
<p>So the cost of buying 5 tokens for outcome A from this market is:</p>
<p>$$ \nu = C \begin{pmatrix} -5 \\ 4 \end{pmatrix} - C \begin{pmatrix} -10 \\ 4 \end{pmatrix} \approx 4.765 - 4.295 = 0.470 $$</p>
<p>Similarly, selling 2 tokens for outcome B (or having the market buy those tokens from you) would yield a cost of:</p>
<p>$$ \nu = C \begin{pmatrix} -10 \\ 2 \end{pmatrix} - C \begin{pmatrix} -10 \\ 4 \end{pmatrix} \approx -1.861 $$</p>
<p>That is to say, the market will buy 2 tokens of outcome B for 1.861 units of collateral.</p>
<div class="section" id="bounded-loss-from-the-b-parameter">
<span id="bounded-loss-from-the-b-parameter"></span><h2>Bounded Loss from the \(b\) Parameter<a class="headerlink" href="#bounded-loss-from-the-b-parameter" title="Permalink to this headline">¶</a></h2>
<p>Here is the worst scenario for the market maker: everybody but the market maker already knows which one of the \(n\) outcomes will occur. Without loss of generality, let the answer be the first outcome token. Everybody buys outcome one tokens from the market maker while selling off every other worthless outcome token they hold. The cost function for the market maker goes from</p>
<p>$$ C \begin{pmatrix} 0 \\ 0 \\ 0 \\ \vdots \end{pmatrix} = b \log n $$</p>
<p>to</p>
<p>$$ C \begin{pmatrix} q_1 \\ -\infty \\ -\infty \\ \vdots \end{pmatrix} = b \log \left( \exp \left( {q_1 \over b} \right) \right) = q_1 $$</p>
<p>The market sells \(q_1\) shares of outcome one and buys shares for every other outcome until those outcome tokens become worthless to the market maker. This costs the participants \((q_1 - b \log n)\) in collateral, and thus, when the participants gain \(q_1\) from redeeming their winnings, this nets the participants \((b \log n)\) in collateral. This gain for the participant is equal to the market’s loss.</p>
<p>Thus, in order to guarantee that a market can operate with a liquidity parameter of \(b\), it must be funded with \((F = b \log n)\) of collateral. Another way to look at this is that the market’s funding determines its \(b\) parameter:</p>
<p>$$ b = {F \over \log n} $$</p>
<p>In the Gnosis implementation, the <a class="reference external" href="https://gnosis-pm-contracts.readthedocs.io/en/latest/LMSRMarketMaker.html">LMSR market maker contract</a> is provided with the <code class="docutils literal notranslate"><span class="pre">funding</span></code> \(F\) through inspection of the <code class="docutils literal notranslate"><span class="pre">market</span></code>, and \(b\) is derived accordingly.</p>
</div>
<div class="section" id="marginal-price-of-outcome-tokens">
<span id="marginal-price-of-outcome-tokens"></span><h2>Marginal Price of Outcome Tokens<a class="headerlink" href="#marginal-price-of-outcome-tokens" title="Permalink to this headline">¶</a></h2>
<p>Because the cost function is nonlinear, there isn’t a price for outcome tokens which scales with the quantity being purchased. However, the cost function <em>is</em> differentiable, so a marginal price can be quoted for infinitesimal quantities of outcome tokens:</p>
<p>$$ P_i = {\partial C(\vec{q}) \over \partial q_i} = \frac{\exp(q_i / b)}{\sum_k \exp(q_k / b)} $$</p>
<p>In the context of prediction markets, this marginal price can also be interpreted as the market’s estimation of the odds of that outcome occurring.</p>
</div>
<div class="section" id="lmsr-calculation-functions">
<span id="lmsr-calculation-functions"></span><h2>LMSR Calculation Functions<a class="headerlink" href="#lmsr-calculation-functions" title="Permalink to this headline">¶</a></h2>
<p>The functions <a class="reference external" href="api-reference.html#calcLMSRCost">Gnosis.calcLMSRCost</a> and <a class="reference external" href="api-reference.html#calcLMSRProfit">Gnosis.calcLMSRProfit</a> estimate the cost of buying outcome tokens and the profit from selling outcome tokens respectively. The <a class="reference external" href="api-reference.html#calcLMSROutcomeTokenCount">Gnosis.calcLMSROutcomeTokenCount</a> estimates the quantity of an outcome token which can be bought given an amount of collateral and serves as a sort of “inverse calculation” to Gnosis.calcLMSRCost. Finally, <a class="reference external" href="api-reference.html#calcLMSRMarginalPrice">Gnosis.calcLMSRMarginalPrice</a> can be used to get the marginal price of an outcome token.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contributing-guide.html" class="btn btn-neutral float-right" title="Contributing Guide" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="events-oracles-and-markets.html" class="btn btn-neutral" title="Events, Oracles and Markets" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Gnosis.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>